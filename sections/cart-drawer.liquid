<div id="cart-drawer" class="cart-drawer">
  <div class="cart-drawer-header border-b border-gray-200 p-5 flex justify-between items-center">
    <h2 class="font-bannertype text-2xl uppercase text-peanut-brown">Shopping Cart</h2>
    <button class="cart-drawer-close text-2xl" onclick="closeCartDrawer()">&times;</button>
  </div>

  <div id="cart-drawer-content" class="cart-drawer-content">
    {% if cart.item_count > 0 %}
      <div class="cart-items">
        {% for item in cart.items %}
          <div
            class="cart-item p-4 {% unless forloop.last %}border-b border-gray-200{% endunless %}"
            data-line="{{ forloop.index }}"
          >
            <div class="flex gap-4">
              <!-- Left: Image -->
              {% if item.image %}
                <div class="w-24 h-24 bg-gray-50">
                  <img
                    src="{{ item.image | img_url: '200x' }}"
                    alt="{{ item.title | escape }}"
                    width="96"
                    height="96"
                    class="w-full h-full object-contain"
                  >
                </div>
              {% else %}
                <div class="w-24 h-24 bg-gray-50"></div>
              {% endif %}

              <!-- Middle: Product details -->
              <div class="flex-1">
                <div class="flex justify-between items-start">
                  <div>
                    <h3 class="font-medium">{{ item.title }}</h3>
                    <div class="text-gray-600 mt-1">Price: {{ item.final_price | money }}</div>
                  </div>
                  <button
                    type="button"
                    onclick="removeItem({{ forloop.index }})"
                    class="text-gray-400 hover:text-gray-600"
                    aria-label="Remove item"
                  >
                    &times;
                  </button>
                </div>

                <div class="quantity-selector inline-flex mt-3 border border-gray-200">
                  <button
                    type="button"
                    class="quantity-decrease w-8 h-8 flex items-center justify-center text-gray-600"
                    data-line="{{ forloop.index }}"
                    data-action="decrease"
                    aria-label="Decrease quantity"
                  >
                    &minus;
                  </button>
                  <input
                    type="number"
                    name="updates[]"
                    value="{{ item.quantity }}"
                    min="1"
                    readonly
                    class="w-10 h-8 text-center focus:outline-none border-x border-gray-200 [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none"
                    data-line="{{ forloop.index }}"
                    data-item-key="{{ item.key }}"
                  >
                  <button
                    type="button"
                    class="quantity-increase w-8 h-8 flex items-center justify-center text-gray-600"
                    data-line="{{ forloop.index }}"
                    data-action="increase"
                    aria-label="Increase quantity"
                  >
                    &plus;
                  </button>
                </div>
              </div>

              <!-- Hidden price data for JS functionality -->
              <span
                class="hidden item-total"
                data-line="{{ forloop.index }}"
                data-key="{{ item.key }}"
                data-price="{{ item.final_price }}"
              >
                {{ item.final_line_price | money }}
              </span>
            </div>
          </div>
        {% endfor %}
      </div>

      <div class="cart-footer px-4 py-6 border-t border-gray-200">
        <div class="flex justify-between items-center mb-3">
          <span class="text-lg">Subtotal</span>
          <span class="text-lg font-medium">{{ cart.total_price | money }}</span>
        </div>

        <p class="text-gray-500 text-sm mb-4">Shipping and taxes calculated at checkout.</p>

        <button
          type="button"
          onclick="window.location.href='/checkout'"
          class="w-full bg-peanut-brown hover:bg-nabati-pink text-white py-3 px-4 rounded font-medium transition duration-200 mb-3"
        >
          Checkout
        </button>

        <button
          type="button"
          onclick="closeCartDrawer()"
          class="w-full text-center text-peanut-brown hover:text-nabati-pink py-2"
        >
          or Continue Shopping &rarr;
        </button>
      </div>
    {% else %}
      <div class="flex-1 flex flex-col justify-center items-center p-5 text-center">
        <p class="text-peanut-brown mb-5">Your cart is empty</p>
        <button
          type="button"
          onclick="closeCartDrawer();"
          class="text-nabati-pink hover:text-peanut-brown"
        >
          Continue shopping
        </button>
      </div>
    {% endif %}
  </div>
</div>


{% schema %}
{
  "name": "Cart Drawer",
  "settings": []
}
{% endschema %}
